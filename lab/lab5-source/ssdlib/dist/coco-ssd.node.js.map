{"version":3,"file":"coco-ssd.node.js","sources":["../src/classes.ts","../src/version.ts","../src/index.ts"],"sourcesContent":["\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nexport interface ObjectDetectionClass {\n  name: string;\n  id: number;\n  displayName: string;\n}\n\nexport const CLASSES: {[key: string]: ObjectDetectionClass} = {\n  1: {\n    name: '/m/01g317',\n    id: 1,\n    displayName: '사람',\n  },\n  2: {\n    name: '/m/0199g',\n    id: 2,\n    displayName: 'bicycle',\n  },\n  3: {\n    name: '/m/0k4j',\n    id: 3,\n    displayName: '자동차',\n  },\n  4: {\n    name: '/m/04_sv',\n    id: 4,\n    displayName: 'motorcycle',\n  },\n  5: {\n    name: '/m/05czz6l',\n    id: 5,\n    displayName: 'airplane',\n  },\n  6: {\n    name: '/m/01bjv',\n    id: 6,\n    displayName: 'bus',\n  },\n  7: {\n    name: '/m/07jdr',\n    id: 7,\n    displayName: 'train',\n  },\n  8: {\n    name: '/m/07r04',\n    id: 8,\n    displayName: 'truck',\n  },\n  9: {\n    name: '/m/019jd',\n    id: 9,\n    displayName: 'boat',\n  },\n  10: {\n    name: '/m/015qff',\n    id: 10,\n    displayName: 'traffic light',\n  },\n  11: {\n    name: '/m/01pns0',\n    id: 11,\n    displayName: 'fire hydrant',\n  },\n  13: {\n    name: '/m/02pv19',\n    id: 13,\n    displayName: 'stop sign',\n  },\n  14: {\n    name: '/m/015qbp',\n    id: 14,\n    displayName: 'parking meter',\n  },\n  15: {\n    name: '/m/0cvnqh',\n    id: 15,\n    displayName: 'bench',\n  },\n  16: {\n    name: '/m/015p6',\n    id: 16,\n    displayName: 'bird',\n  },\n  17: {\n    name: '/m/01yrx',\n    id: 17,\n    displayName: 'cat',\n  },\n  18: {\n    name: '/m/0bt9lr',\n    id: 18,\n    displayName: '개',\n  },\n  19: {\n    name: '/m/03k3r',\n    id: 19,\n    displayName: 'horse',\n  },\n  20: {\n    name: '/m/07bgp',\n    id: 20,\n    displayName: 'sheep',\n  },\n  21: {\n    name: '/m/01xq0k1',\n    id: 21,\n    displayName: 'cow',\n  },\n  22: {\n    name: '/m/0bwd_0j',\n    id: 22,\n    displayName: 'elephant',\n  },\n  23: {\n    name: '/m/01dws',\n    id: 23,\n    displayName: 'bear',\n  },\n  24: {\n    name: '/m/0898b',\n    id: 24,\n    displayName: 'zebra',\n  },\n  25: {\n    name: '/m/03bk1',\n    id: 25,\n    displayName: 'giraffe',\n  },\n  27: {\n    name: '/m/01940j',\n    id: 27,\n    displayName: 'backpack',\n  },\n  28: {\n    name: '/m/0hnnb',\n    id: 28,\n    displayName: 'umbrella',\n  },\n  31: {\n    name: '/m/080hkjn',\n    id: 31,\n    displayName: 'handbag',\n  },\n  32: {\n    name: '/m/01rkbr',\n    id: 32,\n    displayName: 'tie',\n  },\n  33: {\n    name: '/m/01s55n',\n    id: 33,\n    displayName: 'suitcase',\n  },\n  34: {\n    name: '/m/02wmf',\n    id: 34,\n    displayName: 'frisbee',\n  },\n  35: {\n    name: '/m/071p9',\n    id: 35,\n    displayName: 'skis',\n  },\n  36: {\n    name: '/m/06__v',\n    id: 36,\n    displayName: 'snowboard',\n  },\n  37: {\n    name: '/m/018xm',\n    id: 37,\n    displayName: 'sports ball',\n  },\n  38: {\n    name: '/m/02zt3',\n    id: 38,\n    displayName: '연',\n  },\n  39: {\n    name: '/m/03g8mr',\n    id: 39,\n    displayName: 'baseball bat',\n  },\n  40: {\n    name: '/m/03grzl',\n    id: 40,\n    displayName: 'baseball glove',\n  },\n  41: {\n    name: '/m/06_fw',\n    id: 41,\n    displayName: 'skateboard',\n  },\n  42: {\n    name: '/m/019w40',\n    id: 42,\n    displayName: 'surfboard',\n  },\n  43: {\n    name: '/m/0dv9c',\n    id: 43,\n    displayName: 'tennis racket',\n  },\n  44: {\n    name: '/m/04dr76w',\n    id: 44,\n    displayName: 'bottle',\n  },\n  46: {\n    name: '/m/09tvcd',\n    id: 46,\n    displayName: 'wine glass',\n  },\n  47: {\n    name: '/m/08gqpm',\n    id: 47,\n    displayName: 'cup',\n  },\n  48: {\n    name: '/m/0dt3t',\n    id: 48,\n    displayName: 'fork',\n  },\n  49: {\n    name: '/m/04ctx',\n    id: 49,\n    displayName: 'knife',\n  },\n  50: {\n    name: '/m/0cmx8',\n    id: 50,\n    displayName: 'spoon',\n  },\n  51: {\n    name: '/m/04kkgm',\n    id: 51,\n    displayName: 'bowl',\n  },\n  52: {\n    name: '/m/09qck',\n    id: 52,\n    displayName: 'banana',\n  },\n  53: {\n    name: '/m/014j1m',\n    id: 53,\n    displayName: 'apple',\n  },\n  54: {\n    name: '/m/0l515',\n    id: 54,\n    displayName: 'sandwich',\n  },\n  55: {\n    name: '/m/0cyhj_',\n    id: 55,\n    displayName: 'orange',\n  },\n  56: {\n    name: '/m/0hkxq',\n    id: 56,\n    displayName: 'broccoli',\n  },\n  57: {\n    name: '/m/0fj52s',\n    id: 57,\n    displayName: 'carrot',\n  },\n  58: {\n    name: '/m/01b9xk',\n    id: 58,\n    displayName: 'hot dog',\n  },\n  59: {\n    name: '/m/0663v',\n    id: 59,\n    displayName: 'pizza',\n  },\n  60: {\n    name: '/m/0jy4k',\n    id: 60,\n    displayName: 'donut',\n  },\n  61: {\n    name: '/m/0fszt',\n    id: 61,\n    displayName: 'cake',\n  },\n  62: {\n    name: '/m/01mzpv',\n    id: 62,\n    displayName: 'chair',\n  },\n  63: {\n    name: '/m/02crq1',\n    id: 63,\n    displayName: 'couch',\n  },\n  64: {\n    name: '/m/03fp41',\n    id: 64,\n    displayName: 'potted plant',\n  },\n  65: {\n    name: '/m/03ssj5',\n    id: 65,\n    displayName: 'bed',\n  },\n  67: {\n    name: '/m/04bcr3',\n    id: 67,\n    displayName: 'dining table',\n  },\n  70: {\n    name: '/m/09g1w',\n    id: 70,\n    displayName: 'toilet',\n  },\n  72: {\n    name: '/m/07c52',\n    id: 72,\n    displayName: 'tv',\n  },\n  73: {\n    name: '/m/01c648',\n    id: 73,\n    displayName: 'laptop',\n  },\n  74: {\n    name: '/m/020lf',\n    id: 74,\n    displayName: 'mouse',\n  },\n  75: {\n    name: '/m/0qjjc',\n    id: 75,\n    displayName: 'remote',\n  },\n  76: {\n    name: '/m/01m2v',\n    id: 76,\n    displayName: 'keyboard',\n  },\n  77: {\n    name: '/m/050k8',\n    id: 77,\n    displayName: 'cell phone',\n  },\n  78: {\n    name: '/m/0fx9l',\n    id: 78,\n    displayName: 'microwave',\n  },\n  79: {\n    name: '/m/029bxz',\n    id: 79,\n    displayName: 'oven',\n  },\n  80: {\n    name: '/m/01k6s3',\n    id: 80,\n    displayName: 'toaster',\n  },\n  81: {\n    name: '/m/0130jx',\n    id: 81,\n    displayName: 'sink',\n  },\n  82: {\n    name: '/m/040b_t',\n    id: 82,\n    displayName: 'refrigerator',\n  },\n  84: {\n    name: '/m/0bt_c3',\n    id: 84,\n    displayName: 'book',\n  },\n  85: {\n    name: '/m/01x3z',\n    id: 85,\n    displayName: 'clock',\n  },\n  86: {\n    name: '/m/02s195',\n    id: 86,\n    displayName: 'vase',\n  },\n  87: {\n    name: '/m/01lsmm',\n    id: 87,\n    displayName: 'scissors',\n  },\n  88: {\n    name: '/m/0kmg4',\n    id: 88,\n    displayName: 'teddy bear',\n  },\n  89: {\n    name: '/m/03wvsk',\n    id: 89,\n    displayName: 'hair drier',\n  },\n  90: {\n    name: '/m/012xff',\n    id: 90,\n    displayName: 'toothbrush',\n  }\n};\n","/** @license See the LICENSE file. */\n\n// This code is auto-generated, do not modify this file!\nconst version = '2.2.2';\nexport {version};\n","/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport * as tfconv from '@tensorflow/tfjs-converter';\nimport * as tf from '@tensorflow/tfjs-core';\n\nimport {CLASSES} from './classes';\n\nconst BASE_PATH = 'https://storage.googleapis.com/tfjs-models/savedmodel/';\n\nexport {version} from './version';\n\n/** @docinline */\nexport type ObjectDetectionBaseModel =\n    'mobilenet_v1'|'mobilenet_v2'|'lite_mobilenet_v2';\n\nexport interface DetectedObject {\n  bbox: [number, number, number, number];  // [x, y, width, height]\n  class: string;\n  score: number;\n}\n\n/**\n * Coco-ssd model loading is configurable using the following config dictionary.\n */\nexport interface ModelConfig {\n  /**\n   * It determines wich object detection architecture to load. The supported\n   * architectures are: 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.\n   * It is default to 'lite_mobilenet_v2'.\n   */\n  base?: ObjectDetectionBaseModel;\n  /**\n   *\n   * An optional string that specifies custom url of the model. This is useful\n   * for area/countries that don't have access to the model hosted on GCP.\n   */\n  modelUrl?: string;\n}\n\nexport async function load(config: ModelConfig = {}) {\n  if (tf == null) {\n    throw new Error(\n        `Cannot find TensorFlow.js. If you are using a <script> tag, please ` +\n        `also include @tensorflow/tfjs on the page before using this model.`);\n  }\n  const base = config.base || 'lite_mobilenet_v2';\n  const modelUrl = config.modelUrl;\n  if (['mobilenet_v1', 'mobilenet_v2', 'lite_mobilenet_v2'].indexOf(base) ===\n      -1) {\n    throw new Error(\n        `ObjectDetection constructed with invalid base model ` +\n        `${base}. Valid names are 'mobilenet_v1',` +\n        ` 'mobilenet_v2' and 'lite_mobilenet_v2'.`);\n  }\n\n  const objectDetection = new ObjectDetection(base, modelUrl);\n  await objectDetection.load();\n  return objectDetection;\n}\n\nexport class ObjectDetection {\n  private modelPath: string;\n  private model: tfconv.GraphModel;\n\n  constructor(base: ObjectDetectionBaseModel, modelUrl?: string) {\n    this.modelPath =\n        modelUrl || `${BASE_PATH}${this.getPrefix(base)}/model.json`;\n  }\n\n  private getPrefix(base: ObjectDetectionBaseModel) {\n    return base === 'lite_mobilenet_v2' ? `ssd${base}` : `ssd_${base}`;\n  }\n\n  async load() {\n    this.model = await tfconv.loadGraphModel(this.modelPath);\n\n    const zeroTensor = tf.zeros([1, 300, 300, 3], 'int32');\n    // Warmup the model.\n    const result = await this.model.executeAsync(zeroTensor) as tf.Tensor[];\n    await Promise.all(result.map(t => t.data()));\n    result.map(t => t.dispose());\n    zeroTensor.dispose();\n  }\n\n  /**\n   * Infers through the model.\n   *\n   * @param img The image to classify. Can be a tensor or a DOM element image,\n   * video, or canvas.\n   * @param maxNumBoxes The maximum number of bounding boxes of detected\n   * objects. There can be multiple objects of the same class, but at different\n   * locations. Defaults to 20.\n   * @param minScore The minimum score of the returned bounding boxes\n   * of detected objects. Value between 0 and 1. Defaults to 0.5.\n   */\n  private async infer(\n      img: tf.Tensor3D|ImageData|HTMLImageElement|HTMLCanvasElement|\n      HTMLVideoElement,\n      maxNumBoxes: number, minScore: number): Promise<DetectedObject[]> {\n    const batched = tf.tidy(() => {\n      if (!(img instanceof tf.Tensor)) {\n        img = tf.browser.fromPixels(img);\n      }\n      // Reshape to a single-element batch so we can pass it to executeAsync.\n      return tf.expandDims(img);\n    });\n    const height = batched.shape[1];\n    const width = batched.shape[2];\n\n    // model returns two tensors:\n    // 1. box classification score with shape of [1, 1917, 90]\n    // 2. box location with shape of [1, 1917, 1, 4]\n    // where 1917 is the number of box detectors, 90 is the number of classes.\n    // and 4 is the four coordinates of the box.\n    const result = await this.model.executeAsync(batched) as tf.Tensor[];\n\n    const scores = result[0].dataSync() as Float32Array;\n    const boxes = result[1].dataSync() as Float32Array;\n\n    // clean the webgl tensors\n    batched.dispose();\n    tf.dispose(result);\n\n    const [maxScores, classes] =\n        this.calculateMaxScores(scores, result[0].shape[1], result[0].shape[2]);\n\n    const prevBackend = tf.getBackend();\n    // run post process in cpu\n    if (tf.getBackend() === 'webgl') {\n      tf.setBackend('cpu');\n    }\n    const indexTensor = tf.tidy(() => {\n      const boxes2 =\n          tf.tensor2d(boxes, [result[1].shape[1], result[1].shape[3]]);\n      return tf.image.nonMaxSuppression(\n          boxes2, maxScores, maxNumBoxes, minScore, minScore);\n    });\n\n    const indexes = indexTensor.dataSync() as Float32Array;\n    indexTensor.dispose();\n\n    // restore previous backend\n    if (prevBackend !== tf.getBackend()) {\n      tf.setBackend(prevBackend);\n    }\n\n    return this.buildDetectedObjects(\n        width, height, boxes, maxScores, indexes, classes);\n  }\n\n  private buildDetectedObjects(\n      width: number, height: number, boxes: Float32Array, scores: number[],\n      indexes: Float32Array, classes: number[]): DetectedObject[] {\n    const count = indexes.length;\n    const objects: DetectedObject[] = [];\n    for (let i = 0; i < count; i++) {\n      const bbox = [];\n      for (let j = 0; j < 4; j++) {\n        bbox[j] = boxes[indexes[i] * 4 + j];\n      }\n      const minY = bbox[0] * height;\n      const minX = bbox[1] * width;\n      const maxY = bbox[2] * height;\n      const maxX = bbox[3] * width;\n      bbox[0] = minX;\n      bbox[1] = minY;\n      bbox[2] = maxX - minX;\n      bbox[3] = maxY - minY;\n      objects.push({\n        bbox: bbox as [number, number, number, number],\n        class: CLASSES[classes[indexes[i]] + 1].displayName,\n        score: scores[indexes[i]]\n      });\n    }\n    return objects;\n  }\n\n  private calculateMaxScores(\n      scores: Float32Array, numBoxes: number,\n      numClasses: number): [number[], number[]] {\n    const maxes = [];\n    const classes = [];\n    for (let i = 0; i < numBoxes; i++) {\n      let max = Number.MIN_VALUE;\n      let index = -1;\n      for (let j = 0; j < numClasses; j++) {\n        if (scores[i * numClasses + j] > max) {\n          max = scores[i * numClasses + j];\n          index = j;\n        }\n      }\n      maxes[i] = max;\n      classes[i] = index;\n    }\n    return [maxes, classes];\n  }\n\n  /**\n   * Detect objects for an image returning a list of bounding boxes with\n   * assocated class and score.\n   *\n   * @param img The image to detect objects from. Can be a tensor or a DOM\n   *     element image, video, or canvas.\n   * @param maxNumBoxes The maximum number of bounding boxes of detected\n   * objects. There can be multiple objects of the same class, but at different\n   * locations. Defaults to 20.\n   * @param minScore The minimum score of the returned bounding boxes\n   * of detected objects. Value between 0 and 1. Defaults to 0.5.\n   */\n  async detect(\n      img: tf.Tensor3D|ImageData|HTMLImageElement|HTMLCanvasElement|\n      HTMLVideoElement,\n      maxNumBoxes = 20, minScore = 0.3): Promise<DetectedObject[]> {\n    return this.infer(img, maxNumBoxes, minScore);\n  }\n\n  /**\n   * Dispose the tensors allocated by the model. You should call this when you\n   * are done with the model.\n   */\n  dispose() {\n    if (this.model != null) {\n      this.model.dispose();\n    }\n  }\n}\n"],"names":["tfconv.loadGraphModel","tf.zeros","tf.tidy","tf.Tensor","tf.browser","tf.expandDims","tf.dispose","tf.getBackend","tf.setBackend","tf.tensor2d","tf.image"],"mappings":"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"}